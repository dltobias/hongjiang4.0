<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>要货历史 - 烘匠 BakeManager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
</head>
<body class="bg-[#f7f7f5] h-screen flex flex-col">

    <!-- 顶部导航栏 -->
    <div class="bg-white px-4 py-3 shadow-sm border-b border-gray-100 z-30 flex-shrink-0">
        <div class="flex items-center justify-between mb-3">
            <div class="flex items-center space-x-3">
                <a href="yaohuo-zhuye.html" class="w-10 h-10 flex items-center justify-center rounded-full bg-white border border-gray-200 shadow-sm text-gray-700 hover:bg-gray-50 hover:border-gray-300 transition-all active:scale-95">
                    <i class="fas fa-chevron-left text-sm"></i>
                </a>
                <h1 class="text-xl font-bold text-gray-800">要货历史</h1>
            </div>
            <div class="flex items-center space-x-2">
                <button onclick="openDateFilter()" class="w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-50 text-gray-600 transition-colors">
                    <i class="fas fa-calendar-alt text-lg"></i>
                </button>
            </div>
        </div>
        
        <!-- 搜索栏 -->
        <div class="relative">
            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            <input type="text" class="search-input" placeholder="搜索单号、门店、商品...">
        </div>
    </div>

    <!-- 列表区域 -->
    <div class="flex-1 overflow-y-auto p-4 custom-scrollbar space-y-3">
        
        <!-- 历史记录项 1 -->
        <div class="card p-4 border-l-4 border-l-green-400" onclick="viewDetail('YH20231024005', 'completed')">
            <div class="flex justify-between items-start mb-3">
                <div class="flex items-center gap-2">
                    <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600 font-bold text-sm">
                        C
                    </div>
                    <div>
                        <div class="font-bold text-gray-800 text-sm">社区便民店</div>
                        <div class="text-xs text-gray-500">单号: YH20231024005</div>
                    </div>
                </div>
                <span class="status-pill status-completed">
                    <i class="fas fa-check-circle mr-1"></i> 已完成
                </span>
            </div>
            
            <div class="bg-gray-50 rounded-lg p-3 mb-3">
                <div class="flex justify-between text-sm mb-1">
                    <span class="text-gray-600">牛皮纸包装袋</span>
                    <span class="font-medium">x100</span>
                </div>
                <div class="text-xs text-gray-400 mt-2">...共 1 种商品</div>
            </div>
            
            <div class="flex justify-between items-center">
                <span class="text-xs text-gray-400">2023-10-24 16:20</span>
                <span class="text-xs font-bold text-gray-700">¥ 80.00</span>
            </div>
        </div>

        <!-- 历史记录项 2 -->
        <div class="card p-4" onclick="viewDetail('YH20231023012', 'completed')">
            <div class="flex justify-between items-start mb-3">
                <div class="flex items-center gap-2">
                    <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-sm">
                        A
                    </div>
                    <div>
                        <div class="font-bold text-gray-800 text-sm">市中心旗舰店</div>
                        <div class="text-xs text-gray-500">单号: YH20231023012</div>
                    </div>
                </div>
                <span class="status-pill status-completed">
                    <i class="fas fa-check-circle mr-1"></i> 已完成
                </span>
            </div>
            
            <div class="bg-gray-50 rounded-lg p-3 mb-3">
                <div class="flex justify-between text-sm mb-1">
                    <span class="text-gray-600">法式牛角包面团</span>
                    <span class="font-medium">x200</span>
                </div>
                <div class="text-xs text-gray-400 mt-2">...共 3 种商品</div>
            </div>
            
            <div class="flex justify-between items-center">
                <span class="text-xs text-gray-400">2023-10-23 09:10</span>
                <span class="text-xs font-bold text-gray-700">¥ 2,400.00</span>
            </div>
        </div>
        
        <!-- 历史记录项 3 -->
        <div class="card p-4 border-l-4 border-l-red-400" onclick="viewDetail('YH20231022008', 'rejected')">
            <div class="flex justify-between items-start mb-3">
                <div class="flex items-center gap-2">
                    <div class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-600 font-bold text-sm">
                        B
                    </div>
                    <div>
                        <div class="font-bold text-gray-800 text-sm">科技园分店</div>
                        <div class="text-xs text-gray-500">单号: YH20231022008</div>
                    </div>
                </div>
                <span class="status-pill status-rejected">
                    <i class="fas fa-times-circle mr-1"></i> 已驳回
                </span>
            </div>
            
            <div class="bg-gray-50 rounded-lg p-3 mb-3">
                <div class="text-xs text-red-500 mb-2">驳回原因: 库存不足，请重新提交</div>
                <div class="flex justify-between text-sm mb-1">
                    <span class="text-gray-600">草莓慕斯</span>
                    <span class="font-medium">x50</span>
                </div>
            </div>
            
            <div class="flex justify-between items-center">
                <span class="text-xs text-gray-400">2023-10-22 14:30</span>
                <button class="text-orange-500 text-xs font-medium px-2 py-1 rounded hover:bg-orange-50" onclick="event.stopPropagation(); window.location.href='yaohuoxinjian.html?reorder=YH20231022008'">
                    重新提交
                </button>
            </div>
        </div>

    </div>

    <!-- 日期筛选弹窗 -->
    <div id="dateFilterModal" class="fixed inset-0 z-50 hidden">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity opacity-0" id="dateFilterBackdrop" onclick="closeDateFilter()"></div>
        <!-- Content -->
        <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl p-5 transform translate-y-full transition-transform duration-300" id="dateFilterContent">
            <!-- Header -->
            <div class="flex justify-between items-center mb-6">
                <h3 class="font-bold text-gray-800 text-lg">日期筛选</h3>
                <button onclick="closeDateFilter()" class="w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-gray-400 hover:bg-gray-100 transition-colors">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <!-- Quick Tags -->
            <div class="mb-6">
                <div class="text-xs text-gray-400 mb-3 font-medium">快速选择</div>
                <div class="flex gap-3 overflow-x-auto no-scrollbar pb-1">
                    <button class="px-4 py-2 rounded-xl bg-orange-50 text-orange-600 text-sm font-bold border border-orange-100 whitespace-nowrap active:scale-95 transition-transform" onclick="selectDateRange('thisMonth')">本月</button>
                    <button class="px-4 py-2 rounded-xl bg-gray-50 text-gray-600 text-sm font-medium border border-transparent whitespace-nowrap active:scale-95 transition-transform" onclick="selectDateRange('lastMonth')">上月</button>
                    <button class="px-4 py-2 rounded-xl bg-gray-50 text-gray-600 text-sm font-medium border border-transparent whitespace-nowrap active:scale-95 transition-transform" onclick="selectDateRange('last7Days')">近7天</button>
                </div>
            </div>
            <!-- Date Range -->
            <div class="mb-8">
                <div class="text-xs text-gray-400 mb-3 font-medium">自定义范围</div>
                <div class="flex items-center gap-3">
                    <div class="flex-1 bg-gray-50 rounded-xl px-3 py-2.5 border border-gray-100 focus-within:border-orange-200 focus-within:ring-2 focus-within:ring-orange-50 transition-all">
                        <input type="date" id="startDate" class="w-full bg-transparent border-none text-sm text-gray-800 focus:ring-0 p-0">
                    </div>
                    <span class="text-gray-300">-</span>
                    <div class="flex-1 bg-gray-50 rounded-xl px-3 py-2.5 border border-gray-100 focus-within:border-orange-200 focus-within:ring-2 focus-within:ring-orange-50 transition-all">
                        <input type="date" id="endDate" class="w-full bg-transparent border-none text-sm text-gray-800 focus:ring-0 p-0">
                    </div>
                </div>
            </div>
            <!-- Buttons -->
            <div class="flex gap-4">
                <button class="flex-1 py-3 rounded-xl bg-gray-100 text-gray-600 font-bold text-sm active:scale-95 transition-transform" onclick="closeDateFilter()">重置</button>
                <button class="flex-1 py-3 rounded-xl bg-orange-500 text-white font-bold text-sm shadow-lg shadow-orange-200 active:scale-95 transition-transform" onclick="applyDateFilter()">确认筛选</button>
            </div>
        </div>
    </div>

    <script>
        function viewDetail(id, status) {
            window.location.href = 'yaohuoxiangqing.html?id=' + id + '&status=' + status;
        }

        // --- 日期筛选逻辑 ---
        
        function openDateFilter() {
            const modal = document.getElementById('dateFilterModal');
            const backdrop = document.getElementById('dateFilterBackdrop');
            const content = document.getElementById('dateFilterContent');
            
            modal.classList.remove('hidden');
            // 强制重绘
            void modal.offsetWidth;
            
            backdrop.classList.remove('opacity-0');
            content.classList.remove('translate-y-full');
        }

        function closeDateFilter() {
            const modal = document.getElementById('dateFilterModal');
            const backdrop = document.getElementById('dateFilterBackdrop');
            const content = document.getElementById('dateFilterContent');
            
            backdrop.classList.add('opacity-0');
            content.classList.add('translate-y-full');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        function applyDateFilter() {
            const start = document.getElementById('startDate').value;
            const end = document.getElementById('endDate').value;
            
            // 简单的交互反馈
            closeDateFilter();
            
            // 模拟筛选加载
            const list = document.querySelector('.custom-scrollbar');
            list.style.opacity = '0.5';
            
            setTimeout(() => {
                list.style.opacity = '1';
                // 这里可以根据实际情况显示 Toast 或刷新列表
                console.log(`Filtering from ${start} to ${end}`);
            }, 500);
        }

        function selectDateRange(range) {
            const now = new Date();
            const startEl = document.getElementById('startDate');
            const endEl = document.getElementById('endDate');
            
            // 简单的日期计算示例
            if (range === 'last7Days') {
                const past = new Date(now);
                past.setDate(now.getDate() - 7);
                startEl.valueAsDate = past;
                endEl.valueAsDate = now;
            } else if (range === 'thisMonth') {
                const start = new Date(now.getFullYear(), now.getMonth(), 1);
                startEl.valueAsDate = start;
                endEl.valueAsDate = now;
            }
            // ... 其他逻辑
        }
    </script>

</body>
</html>