<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>仓库管理 - 烘匠 BakeManager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* Cookpad Design System */
        :root {
            --primary-orange: #ff9f43;
            --primary-dark: #ff8c00;
            --text-main: #333333;
            --text-sub: #8b8b8b;
            --bg-light: #f7f7f5;
            --bg-white: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-light);
            color: var(--text-main);
            -webkit-tap-highlight-color: transparent;
        }

        /* 滚动条美化 */
        .custom-scrollbar::-webkit-scrollbar {
            width: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 3px;
        }
        
        /* 隐藏滚动条 */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* 仓库卡片样式 */
        .warehouse-card {
            background: var(--bg-white);
            border-radius: 16px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.02);
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        
        .warehouse-card:active {
            transform: scale(0.99);
        }
        
        .status-dot {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* 标签页样式 - 类似 kucunyujing.html */
        .tab-btn {
            position: relative;
            color: var(--text-sub);
            transition: all 0.3s;
            padding: 12px 16px;
            font-weight: 500;
            font-size: 14px;
            white-space: nowrap;
        }
        
        .tab-btn.active {
            color: var(--primary-dark);
            font-weight: 700;
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 24px;
            height: 3px;
            background-color: var(--primary-orange);
            border-radius: 3px;
        }
        
        .warehouse-type-badge {
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .warehouse-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* 统一图标样式 */
        .icon-base {
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        /* 颜色变体 */
        .icon-orange { background-color: #fff7ed; color: #ea580c; }
        .icon-blue { background-color: #eff6ff; color: #2563eb; }
        .icon-green { background-color: #ecfdf5; color: #059669; }
        .icon-purple { background-color: #f5f3ff; color: #7c3aed; }
        .icon-red { background-color: #fef2f2; color: #dc2626; }
        .icon-cyan { background-color: #ecfeff; color: #0891b2; }

        /* 动画 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-50 h-screen flex flex-col overflow-hidden">
    <!-- 顶部导航栏 -->
    <div class="bg-white px-4 py-3 shadow-sm border-b border-gray-100 z-30 flex-shrink-0">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <button onclick="goBack()" class="w-9 h-9 flex items-center justify-center rounded-full bg-gray-50 hover:bg-gray-100 transition-all text-gray-600">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div>
                    <div class="text-lg font-bold text-gray-800 tracking-wide">仓库列表</div>
                    <div class="text-xs text-gray-500 font-medium mt-0.5">
                        <span id="headerStats">共 8 个仓库</span>
                    </div>
                </div>
            </div>
            <div class="flex items-center space-x-2">
                <button onclick="createWarehouse()" class="w-9 h-9 flex items-center justify-center rounded-full bg-orange-50 hover:bg-orange-100 transition-all text-orange-600">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- 搜索栏 -->
    <div class="bg-white px-4 py-2 flex-shrink-0">
        <div class="relative">
            <input type="text" placeholder="搜索仓库名称、编号或类型..." 
                   class="w-full bg-gray-100 rounded-xl px-4 py-2.5 pl-10 text-sm border-none focus:outline-none focus:ring-2 focus:ring-orange-100 focus:bg-white transition-all"
                   id="searchInput">
            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            <button class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 hidden" 
                    id="clearSearch" 
                    onclick="clearSearchInput()">
                <i class="fas fa-times-circle"></i>
            </button>
        </div>
    </div>

    <!-- 筛选标签 -->
    <div class="bg-white border-b border-gray-100 flex-shrink-0 z-20">
        <div class="flex px-4 overflow-x-auto no-scrollbar">
            <button class="tab-btn active" onclick="switchTab(this, 'all')">全部</button>
            <button class="tab-btn" onclick="switchTab(this, 'raw')">原料仓</button>
            <button class="tab-btn" onclick="switchTab(this, 'product')">成品仓</button>
            <button class="tab-btn" onclick="switchTab(this, 'frozen')">冷冻仓</button>
            <button class="tab-btn" onclick="switchTab(this, 'normal')">常温仓</button>
            <button class="tab-btn" onclick="switchTab(this, 'damaged')">报损仓</button>
        </div>
    </div>

    <!-- 仓库列表 (Scrollable) -->
    <div class="flex-1 overflow-y-auto custom-scrollbar p-4 space-y-3 bg-gray-50" id="warehouseList">
        <!-- 列表内容将通过JS动态生成 -->
    </div>

    <!-- 空状态 (Hidden by default) -->
    <div id="emptyState" class="hidden flex flex-col items-center justify-center flex-1">
        <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4 text-gray-300 text-3xl">
            <i class="fas fa-warehouse"></i>
        </div>
        <h3 class="text-lg font-semibold text-gray-600 mb-1">暂无仓库</h3>
        <p class="text-sm text-gray-400 mb-6">点击右上角 + 号创建您的第一个仓库</p>
    </div>

    <script>
        // 模拟仓库数据
        const warehousesData = [
            {
                id: 1,
                name: '主原料仓',
                code: 'WH001',
                type: 'raw',
                typeName: '原料仓',
                enabled: true,
                alertCount: 3,
                itemCount: 45,
                utilization: 78,
                location: 'A区1层',
                description: '存放面粉、糖等基础原料'
            },
            {
                id: 2,
                name: '成品仓库',
                code: 'WH002',
                type: 'product',
                typeName: '成品仓',
                enabled: true,
                alertCount: 0,
                itemCount: 28,
                utilization: 45,
                location: 'B区2层',
                description: '存放已完成的烘焙产品'
            },
            {
                id: 3,
                name: '冷冻储存区',
                code: 'WH003',
                type: 'frozen',
                typeName: '冷冻仓',
                enabled: true,
                alertCount: 1,
                itemCount: 15,
                utilization: 65,
                location: 'C区地下1层',
                description: '冷冻保存易腐原料'
            },
            {
                id: 4,
                name: '辅料仓库',
                code: 'WH004',
                type: 'raw',
                typeName: '原料仓',
                enabled: true,
                alertCount: 0,
                itemCount: 32,
                utilization: 52,
                location: 'A区2层',
                description: '存放香精、色素等辅助原料'
            },
            {
                id: 5,
                name: '包装材料仓',
                code: 'WH005',
                type: 'normal',
                typeName: '常温仓',
                enabled: true,
                alertCount: 0,
                itemCount: 18,
                utilization: 30,
                location: 'D区1层',
                description: '存放包装盒、袋等包装材料'
            },
            {
                id: 6,
                name: '报损仓库',
                code: 'WH006',
                type: 'damaged',
                typeName: '报损仓',
                enabled: true,
                alertCount: 0,
                itemCount: 5,
                utilization: 15,
                location: 'E区1层',
                description: '临时存放待处理的报损物品'
            },
            {
                id: 7,
                name: '临时仓库',
                code: 'WH007',
                type: 'normal',
                typeName: '常温仓',
                enabled: false,
                alertCount: 0,
                itemCount: 0,
                utilization: 0,
                location: 'F区1层',
                description: '临时存放区域，当前未启用'
            },
            {
                id: 8,
                name: '季节性仓库',
                code: 'WH008',
                type: 'raw',
                typeName: '原料仓',
                enabled: true,
                alertCount: 1,
                itemCount: 22,
                utilization: 40,
                location: 'G区1层',
                description: '存放季节性特殊原料'
            }
        ];

        let filteredWarehouses = [...warehousesData];
        let currentFilter = 'all';

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            renderWarehouses();
            bindEvents();
        });

        // 绑定事件
        function bindEvents() {
            // 搜索功能
            const searchInput = document.getElementById('searchInput');
            const clearSearch = document.getElementById('clearSearch');
            
            searchInput.addEventListener('input', function() {
                if (this.value.length > 0) {
                    clearSearch.classList.remove('hidden');
                    performSearch(this.value);
                } else {
                    clearSearch.classList.add('hidden');
                    filterWarehouses(currentFilter);
                }
            });
        }

        // 切换标签
        function switchTab(btn, filter) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            currentFilter = filter;
            filterWarehouses(filter);
        }

        // 筛选仓库
        function filterWarehouses(filter) {
            const searchVal = document.getElementById('searchInput').value.toLowerCase();
            
            let baseList = warehousesData;
            if (filter !== 'all') {
                baseList = warehousesData.filter(w => w.type === filter);
            }
            
            if (searchVal) {
                filteredWarehouses = baseList.filter(warehouse => 
                    warehouse.name.toLowerCase().includes(searchVal) ||
                    warehouse.code.toLowerCase().includes(searchVal) ||
                    warehouse.typeName.toLowerCase().includes(searchVal)
                );
            } else {
                filteredWarehouses = baseList;
            }
            
            renderWarehouses();
        }

        // 搜索功能
        function performSearch(query) {
            filterWarehouses(currentFilter);
        }

        // 清空搜索
        function clearSearchInput() {
            const searchInput = document.getElementById('searchInput');
            const clearSearch = document.getElementById('clearSearch');
            
            searchInput.value = '';
            clearSearch.classList.add('hidden');
            filterWarehouses(currentFilter);
        }

        // 渲染仓库列表
        function renderWarehouses() {
            const container = document.getElementById('warehouseList');
            const emptyState = document.getElementById('emptyState');
            const headerStats = document.getElementById('headerStats');
            
            // 更新头部统计
            const total = filteredWarehouses.length;
            const alertCount = filteredWarehouses.filter(w => w.alertCount > 0).length;
            headerStats.textContent = `共 ${total} 个仓库${alertCount > 0 ? ` · ${alertCount} 个预警` : ''}`;
            
            if (filteredWarehouses.length === 0) {
                container.innerHTML = '';
                container.classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }
            
            container.classList.remove('hidden');
            emptyState.classList.add('hidden');
            
            container.innerHTML = filteredWarehouses.map((warehouse, index) => `
                <div class="warehouse-card p-4 animate-fade-in" style="animation-delay: ${index * 0.05}s" onclick="viewWarehouse(${warehouse.id})">
                    <div class="flex items-start space-x-4">
                        <!-- 仓库图标 -->
                        <div class="warehouse-icon ${getWarehouseIconBg(warehouse.type)} flex-shrink-0">
                            <i class="fas ${getWarehouseIcon(warehouse.type)}"></i>
                        </div>
                        
                        <!-- 仓库信息 -->
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start justify-between mb-1">
                                <div class="flex-1 min-w-0 mr-2">
                                    <h3 class="text-base font-bold text-gray-800 truncate">${warehouse.name}</h3>
                                    <div class="flex items-center gap-2 mt-0.5">
                                        <span class="text-xs font-mono text-gray-400 bg-gray-50 px-1.5 py-0.5 rounded">${warehouse.code}</span>
                                        <span class="text-[10px] font-medium px-1.5 py-0.5 rounded ${getTypeBadgeClass(warehouse.type)}">${warehouse.typeName}</span>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2 flex-shrink-0">
                                    ${warehouse.alertCount > 0 ? `
                                        <div class="flex items-center bg-red-50 px-2 py-0.5 rounded-full border border-red-100">
                                            <i class="fas fa-exclamation-circle text-red-500 text-[10px] mr-1"></i>
                                            <span class="text-[10px] font-bold text-red-600">${warehouse.alertCount}</span>
                                        </div>
                                    ` : ''}
                                    ${warehouse.enabled ? 
                                        `<div class="w-1.5 h-1.5 rounded-full bg-green-500 status-dot"></div>` : 
                                        `<div class="w-1.5 h-1.5 rounded-full bg-gray-300"></div>`
                                    }
                                </div>
                            </div>
                            
                            <p class="text-xs text-gray-500 mb-3 line-clamp-1">${warehouse.description}</p>
                            
                            <div class="flex items-center justify-between text-xs bg-gray-50 p-2 rounded-lg">
                                <div class="text-center flex-1 border-r border-gray-200 last:border-0">
                                    <p class="font-bold text-gray-700">${warehouse.itemCount}</p>
                                    <p class="text-gray-400 scale-90">物料种类</p>
                                </div>
                                <div class="text-center flex-1 border-r border-gray-200 last:border-0">
                                    <p class="font-bold text-gray-700">${warehouse.utilization}%</p>
                                    <p class="text-gray-400 scale-90">利用率</p>
                                </div>
                                <div class="text-center flex-1">
                                    <p class="font-bold text-gray-700 truncate px-1">${warehouse.location}</p>
                                    <p class="text-gray-400 scale-90">位置</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // 获取仓库图标背景
        function getWarehouseIconBg(type) {
            const backgrounds = {
                'raw': 'icon-orange',
                'product': 'icon-green',
                'frozen': 'icon-blue',
                'normal': 'icon-purple',
                'damaged': 'icon-red'
            };
            return backgrounds[type] || 'icon-orange';
        }

        // 获取仓库图标
        function getWarehouseIcon(type) {
            const icons = {
                'raw': 'fa-wheat-awn',
                'product': 'fa-box',
                'frozen': 'fa-snowflake',
                'normal': 'fa-warehouse',
                'damaged': 'fa-exclamation-triangle'
            };
            return icons[type] || 'fa-warehouse';
        }

        // 获取类型标签样式
        function getTypeBadgeClass(type) {
            const classes = {
                'raw': 'bg-orange-50 text-orange-600 border border-orange-100',
                'product': 'bg-green-50 text-green-600 border border-green-100',
                'frozen': 'bg-blue-50 text-blue-600 border border-blue-100',
                'normal': 'bg-gray-50 text-gray-600 border border-gray-100',
                'damaged': 'bg-red-50 text-red-600 border border-red-100'
            };
            return classes[type] || 'bg-gray-50 text-gray-600';
        }

        // 查看仓库详情
        function viewWarehouse(warehouseId) {
            window.location.href = `cangku-xiangqing.html?id=${warehouseId}`;
        }

        // 创建新仓库
        function createWarehouse() {
            window.location.href = 'cangku-shezhi.html';
        }

        // 返回上一页
        function goBack() {
            window.location.href = '../erp-zhuye-canku.html';
        }
    </script>
</body>
</html>